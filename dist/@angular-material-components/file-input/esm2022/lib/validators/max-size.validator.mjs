/**
 * Validator for size of file
 * @param max Max of size of file (in bytes)
 */
export function MaxSizeValidator(max) {
    return (ctrl) => {
        max = Number(max);
        if (isNaN(max)) {
            throw 'MaxSizeValidator: max of size of file is invalid';
        }
        if (!ctrl.value)
            return null;
        let files = ctrl.value;
        if (!Array.isArray(ctrl.value)) {
            files = [ctrl.value];
        }
        if (!files.length)
            return null;
        const add = (a, b) => a + b;
        const sumSize = files.map((x) => x.size).reduce(add);
        if (sumSize > max) {
            return {
                maxSize: true,
            };
        }
        return null;
    };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWF4LXNpemUudmFsaWRhdG9yLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvZmlsZS1pbnB1dC9zcmMvbGliL3ZhbGlkYXRvcnMvbWF4LXNpemUudmFsaWRhdG9yLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUVBOzs7R0FHRztBQUNILE1BQU0sVUFBVSxnQkFBZ0IsQ0FBQyxHQUFXO0lBQzFDLE9BQU8sQ0FBQyxJQUFxQixFQUEyQixFQUFFO1FBQ3hELEdBQUcsR0FBRyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDbEIsSUFBSSxLQUFLLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQztZQUNmLE1BQU0sa0RBQWtELENBQUM7UUFDM0QsQ0FBQztRQUNELElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSztZQUFFLE9BQU8sSUFBSSxDQUFDO1FBQzdCLElBQUksS0FBSyxHQUFXLElBQUksQ0FBQyxLQUFLLENBQUM7UUFDL0IsSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUM7WUFDL0IsS0FBSyxHQUFHLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ3ZCLENBQUM7UUFDRCxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU07WUFBRSxPQUFPLElBQUksQ0FBQztRQUMvQixNQUFNLEdBQUcsR0FBRyxDQUFDLENBQU0sRUFBRSxDQUFNLEVBQVUsRUFBRSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDOUMsTUFBTSxPQUFPLEdBQUcsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUNyRCxJQUFJLE9BQU8sR0FBRyxHQUFHLEVBQUUsQ0FBQztZQUNsQixPQUFPO2dCQUNMLE9BQU8sRUFBRSxJQUFJO2FBQ2QsQ0FBQztRQUNKLENBQUM7UUFDRCxPQUFPLElBQUksQ0FBQztJQUNkLENBQUMsQ0FBQztBQUNKLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBYnN0cmFjdENvbnRyb2wsIFZhbGlkYXRpb25FcnJvcnMsIFZhbGlkYXRvckZuIH0gZnJvbSAnQGFuZ3VsYXIvZm9ybXMnO1xuXG4vKipcbiAqIFZhbGlkYXRvciBmb3Igc2l6ZSBvZiBmaWxlXG4gKiBAcGFyYW0gbWF4IE1heCBvZiBzaXplIG9mIGZpbGUgKGluIGJ5dGVzKVxuICovXG5leHBvcnQgZnVuY3Rpb24gTWF4U2l6ZVZhbGlkYXRvcihtYXg6IG51bWJlcik6IFZhbGlkYXRvckZuIHtcbiAgcmV0dXJuIChjdHJsOiBBYnN0cmFjdENvbnRyb2wpOiBWYWxpZGF0aW9uRXJyb3JzIHwgbnVsbCA9PiB7XG4gICAgbWF4ID0gTnVtYmVyKG1heCk7XG4gICAgaWYgKGlzTmFOKG1heCkpIHtcbiAgICAgIHRocm93ICdNYXhTaXplVmFsaWRhdG9yOiBtYXggb2Ygc2l6ZSBvZiBmaWxlIGlzIGludmFsaWQnO1xuICAgIH1cbiAgICBpZiAoIWN0cmwudmFsdWUpIHJldHVybiBudWxsO1xuICAgIGxldCBmaWxlczogRmlsZVtdID0gY3RybC52YWx1ZTtcbiAgICBpZiAoIUFycmF5LmlzQXJyYXkoY3RybC52YWx1ZSkpIHtcbiAgICAgIGZpbGVzID0gW2N0cmwudmFsdWVdO1xuICAgIH1cbiAgICBpZiAoIWZpbGVzLmxlbmd0aCkgcmV0dXJuIG51bGw7XG4gICAgY29uc3QgYWRkID0gKGE6IGFueSwgYjogYW55KTogbnVtYmVyID0+IGEgKyBiO1xuICAgIGNvbnN0IHN1bVNpemUgPSBmaWxlcy5tYXAoKHgpID0+IHguc2l6ZSkucmVkdWNlKGFkZCk7XG4gICAgaWYgKHN1bVNpemUgPiBtYXgpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIG1heFNpemU6IHRydWUsXG4gICAgICB9O1xuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbiAgfTtcbn1cbiJdfQ==